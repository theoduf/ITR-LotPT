/*
 * Copyright (c) 2018 Erik Nordstr√∏m <erik@nordstroem.no>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
*/
var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(c,b,a){c!=Array.prototype&&c!=Object.prototype&&(c[b]=a.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(c){if(c){for(var b=ba,a=["Array","prototype","fill"],e=0;e<a.length-1;e++){var h=a[e];h in b||(b[h]={});b=b[h]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&aa(b,a,{configurable:!0,writable:!0,value:c})}}
ca(function(c){return c?c:function(b,a,c){var e=this.length||0;0>a&&(a=Math.max(0,e+a));if(null==c||c>e)c=e;c=Number(c);0>c&&(c=Math.max(0,e+c));for(a=Number(a||0);a<c;a++)this[a]=b;return this}});var d=document.title,f=document.getElementById("game"),g=f.getContext("2d"),k=document.createElement("canvas");k.getContext("webgl");var l,m=document.createElement("canvas"),n=m.getContext("2d"),r=Math.acos(1),t=Math.acos(0),u;function v(c,b){return Math.cos(t*c/32)*Math.cos(r*b/20)*u}
function w(c){for(var b=new Float32Array(c.length),a=0;a<c.length;a+=3){var e=c[a],h=c[a+1],p=v(e,h);b[a]=p*e;b[a+1]=p*h}return b}var y,z,A,B;function C(){y=.5*f.width/16;z=f.width/2;A=f.width/4;B=f.height/2}var D,E;
function da(){function c(a,c,e,h,p,x){var q=12*(32*(b-e)+(16+a))/2;a+=c;e+=h;D[q]=a;D[q+1]=e;D[q+3]=a;D[q+4]=e+1*x;D[q+6]=a+2*p;D[q+7]=e+1*x;D[q+9]=a+2*p;D[q+10]=e}C();var b=1;do u=Math.cos(16*t/32)*Math.cos(r*b/20),b++;while(0<z-w([16,b,0])[1]*y);D=new Float32Array(768*b/2);for(var a=0;a<b;a++)for(var e=0;8>e;e++){var h=b-a,p=-a,x=-(16-2*e),S=2*e;c(x,a%2?2:1,h,-1,-1,1);c(S,a%2?0:-1,h,-1,1,1);c(x,a%2?2:1,p,0,-1,-1);c(S,a%2?0:-1,p,0,1,-1)}E=w(D)}var F;
function ea(){var c=Date.now(),b=E;g.fillStyle="#449";g.strokeStyle="#00ffff";for(var a=0;a<b.length;a+=12){g.beginPath();var e=Math.floor(z+y*b[a]),h=Math.floor(B-y*b[a+1]);g.moveTo(e,h);g.lineTo(Math.floor(z+y*b[a+3]),Math.floor(B-y*b[a+4]));g.lineTo(Math.floor(z+y*b[a+6]),Math.floor(B-y*b[a+7]));g.lineTo(Math.floor(z+y*b[a+9]),Math.floor(B-y*b[a+10]));g.lineTo(e,h);g.stroke();g.fill()}g.strokeStyle="#ffff00";g.beginPath();g.moveTo(z,0);g.lineTo(z,f.height);g.moveTo(0,B);g.lineTo(f.width,B);g.moveTo(A,
0);g.lineTo(A,f.height);g.moveTo(z+A,0);g.lineTo(z+A,f.height);g.stroke();b=[-8,0,-8,-9,-7,-9,-6,-9,-5,-9,-4,-9,-3,-9,-2,-9,-1,-9,0,-9,0,0];g.strokeStyle="#ff00ff";g.beginPath();g.moveTo(z,B);for(a=0;a<b.length;a+=2)e=v(b[a],b[a+1]),g.lineTo(z+b[a]*e*y,B-b[a+1]*e*y);g.stroke();g.fillStyle="rgba(255, 0, 255, 0.1)";g.fill();g.strokeStyle="#ff0000";g.beginPath();b=v(-2,-5);g.moveTo(z+-2*b*y,0);g.lineTo(z+-2*b*y,f.height);g.moveTo(0,B+5*b*y);g.lineTo(f.width,B+5*b*y);g.stroke();b=E;g.fillStyle="#ff0000";
for(a=0;a<b.length;a+=12)g.fillRect(Math.floor(z+y*b[a])-1,Math.floor(B-y*b[a+1])-1,2,2);b=Date.now();g.fillStyle="#449";g.fillText("Tower rendered in "+(b-c)+" ms",16,24)}var G,H,I,J,K=Array(240),L;
function fa(){L=!0;g.clearRect(0,0,f.width,f.height);g.drawImage(m,m.width-f.width-F/(4*Math.PI)*m.width,0,f.width,f.height,0,0,f.width,f.height);ea();g.fillStyle="#449";g.fillText("Current frame "+J+" ms",16,36);null!==I&&(H>K.length?g.fillText("Last "+K.length+" frames "+Math.round(1E5/(K.reduce(function(c,b){return c+b})/K.length))/100+" FPS",16,48):30<=H&&g.fillText("Last "+H+" frames "+Math.round(1E5/(K.slice(K.length-H).reduce(function(c,b){return c+b})/H))/100+" FPS",16,48));H++;L=!1}
var M,N,O;function P(){if(!N&&!M){var c=Date.now();null!==I&&(J=c-I,K.shift(),K.push(J));F=(F+G/y*J/1E3)%(2*Math.PI);fa();I=c;requestAnimationFrame(P)}}var Q,R;function T(){var c=window.devicePixelRatio;if(window.innerWidth>16*window.innerHeight/10){var b=window.innerHeight;var a=16*b/10}else a=window.innerWidth,b=10*a/16;f.style.width=Math.floor(a)+"px";f.style.height=Math.floor(b)+"px";a*=c;b*=c;f.width=a;f.height=b;k.width=a;k.height=b;m.width=4*a;m.height=b}var U,V;
function W(){T();var c=l.width,b=Math.ceil(.42*c),a=Math.floor(.35*f.width),e=Math.ceil(.5*a),h=Math.ceil(.42*a);n.drawImage(l,0,b,c,c-b,Math.floor(.5*f.width)-e,0,a,a-h);n.drawImage(l,0,b,c,c-b,Math.floor(2.5*f.width)-e,0,a,a-h);C();H=0;I=null}function X(){O||R()}function Y(){O||Q()}function Z(){window.removeEventListener("blur",X);window.removeEventListener("focus",Y);M=!0;O=N=!1;R=Q=null;H=J=0;I=null;G=3;F=Math.PI/2}
function ha(){Z();R=function(){N=!0;document.title="Paused - "+d;if(L)requestAnimationFrame(R);else{g.fillStyle="rgba(64, 64, 128, 0.45)";g.fillRect(0,0,f.width,f.height);g.fillStyle="#ffffff";var c=.05*f.height;g.fillRect(c,c,c,2.5*c);g.fillRect(2.5*c,c,c,2.5*c)}};Q=function(){N&&(H=0,I=null,M=N=!1,document.title=d,P())};window.addEventListener("blur",X);window.addEventListener("focus",Y);M=!1;P()}
window.addEventListener("load",function(){var c=0;T();g.fillStyle="#000";g.fillRect(0,0,f.width,f.height);f.hidden=!1;l=new Image;l.onload=function(){1===++c&&(da(),window.addEventListener("resize",function(){clearTimeout(U);U=setTimeout(W,30)}),window.addEventListener("orientationchange",function(){clearTimeout(V);V=setTimeout(W,250)}),W(),Z(),ha())};l.src="assets/thirdparty/images/sun.svg"});//# sourceMappingURL=infinite-tower-run.map
